# DigitalCane (디지털 지팡이)

**DigitalCane**은 시각장애인의 독립적인 이동을 보조하기 위해 개발된 iOS 애플리케이션입니다. **공간 인지지도 형성**과 **이동 전 경로 플래닝**에 초점을 맞추어, 주변 환경을 탐색하는 '디지털케인' 모드와 대중교통 경로를 사전에 파악하는 '경로 탐색' 기능을 제공합니다.

---

## 🚀 주요 기능

### 1. 디지털케인 (주변 탐색)
시각장애인이 흰지팡이를 좌우로 흔들며 보행하는 것에서 착안한 기능입니다.
- **탐색 방법 (Vertical Scanning)**: 휴대폰을 **세워서** 마치 사진을 찍듯이 전방을 비추며 탐색합니다. 이는 나침반 센서의 정확도를 높이고 사용자의 팔 피로도를 줄여주는 인체공학적 디자인입니다.
- **지능형 자동 반경 조절 (Smart Radius)**: 앱이 스스로 장소의 밀도를 파악합니다. 번화가에서는 범위를 좁혀 소음을 줄이고, 한적한 곳에서는 범위를 넓혀 정보를 찾아줍니다.
- **정밀 POI 인식 (Hyper-Local Awareness)**: Overpass API를 통해 건물뿐만 아니라 주요 상점(Node)까지 인식합니다. 불필요한 시설(가로등 등)은 거르고 **주차장, 화장실** 등 필수 정보만 똑똑하게 선별하여 안내합니다.
- **현재 건물 인식 및 제외**: 사용자가 현재 위치한 건물을 인식하여 검색 결과에서 자동으로 필터링함으로써, 본인 위치를 주변 장소로 오안내하는 현상을 차단했습니다.
- **자동 시작**: GPS 신호가 잡히면 별도의 조작 없이 주변 탐색이 자동으로 시작됩니다.

### 2. 스마트 경로 탐색 (Route Planning)
단순한 길 안내가 아니라, 시각장애인이 **이동 전에 경로를 머릿속에 그릴 수 있도록** 상세한 정보를 제공합니다.
- **음성 명령**: 화면을 누른 채 "출발지와 목적지를 말씀해 주세요. 출발지를 말하지 않으면 현위치를 중심으로 안내합니다."라는 안내에 따라 자유롭게 말씀하시면 AI가 의도를 완벽하게 파악합니다.
- **지능형 경로 탐색**: 
  - 버스, 지하철뿐만 아니라 **장거리 기차(KTX 등)**까지 포함한 복합 경로를 지원합니다.
  - 별도 설정이 없으면 **최단 시간 경로**를 우선 안내합니다.
  - 사용자가 원할 경우 **'걷기 최소화(안전 우선)'** 또는 **'환승 최소화(편의 우선)'** 등 맞춤형 경로 탐색을 음성 명령이나 설정으로 지원합니다.
- **대화형 브리핑**: "총 3번 탑승하며, 15개 정류장을 지납니다"와 같은 전체 여정 요약 후, 끊김 없이 첫 단계 안내를 이어갑니다.
- **상세 환승 가이드**: "강남역에서 2호선을 타고 역삼역에 내리세요. 교대 방면입니다."와 같이 노선 번호, 방면, 하차역을 명확히 전달합니다.

### 3. 도움요청 센터 (SOS)
사용자가 길을 잃거나 예기치 못한 상황에 직면했을 때 즉각적인 도움을 받을 수 있는 안전 장치입니다.
- **실시간 상세 위치 안내**: `CLGeocoder`의 주소 정보에 **Overpass API의 정밀 건물 판별 결과**를 더해, 단순 주소뿐만 아니라 "OOO 건물 내부"와 같은 실내 정보를 음성(TTS)과 텍스트로 제공합니다.
- **유연한 SMS 전송**: 
  - 설정된 보호자뿐만 아니라, 방문 중인 지인 등 **원하는 수신자를 즉시 수정**하여 문자를 보낼 수 있습니다.
  - 전송 시 **현재 주소**, **상세 건물 정보(내부/주변)**, **구글 지도 링크**가 자동으로 포함됩니다.
- **안심 전화**: 버튼 터치 한 번으로 연락처에 등록된 번호로 즉시 전화를 연결합니다.
- **독립된 탭 구성**: 긴급 상황에서 혼란을 줄이기 위해 탐색 화면과 분리된 전용 SOS 탭을 제공합니다.

---

## 🎨 앱 아이콘

**DigitalCane**의 앱 아이콘은 시각장애인을 위한 보조 공학의 본질을 담고 있습니다:
- 🦯 **흰지팡이 모티프**: 전통적인 이동 보조 도구를 디지털로 확장
- 📡 **레이더 효과**: 주변 탐색 기능을 시각화
- 💛 **노란색 배경**: 고대비 접근성과 희망을 상징
- ⚡ **미니멀 디자인**: 명확하고 즉각적으로 인식 가능한 형태

---

## 🛠 기술 스택

- **Platform**: iOS 16.0+
- **Language**: Swift, SwiftUI
- **Location & Sensors**:
  - `CoreLocation`: 실시간 위치 및 헤딩(방위각) 추적
  - `CLGeocoder`: 위경도 좌표를 실시간 한글 주소(역지오코딩)로 변환
  - `CoreHaptics` / `UIImpactFeedbackGenerator`: 촉각 피드백 제공
- **AI & Data**:
  - **Google Gemini 2.0 Flash**: 사용자 발화 의도 추출 (목적지, 출발지 파싱)
  - **Google Maps Platform**:
    - **Places API v1**: 주변 POI 검색
    - **Places API v1**: 주변 POI 검색
    - **Routes API v2**: 대중교통 및 복합 대중교통경로안내
  - **Overpass API (OSM)**: 건물 형상 및 POI 상세 데이터 수집 (Ray Casting 판별용)
- **Accessibility & UX**: 
  - `VoiceOver` 최적화: 행동 중심 레이아웃, 버튼 특성(Trait) 명시.
  - `Dynamic Type` 지원: 0.8x ~ 2.0x 글자 크기 조절 및 Scroll View 대응.
  - `Anchored Bottom Tab Bar`: iPhone SE 등 모든 기기에서 바닥에 완전히 고정된 고대비 커스텀 탭바 구현 (화면 100% 활용).
  - `AVSpeechSynthesizer`: 자연스러운 한국어 음성 출력 (TTS). **음성 속도 조절** 기능으로 사용자 선호에 맞게 조절 가능.
  - `Tab Refresh`: 탭 재선택 시 데이터 자동 갱신 및 음성 가이드 최적화.
  - **경로 복사**: 경로 안내 화면 상단 요약 영역을 길게 누르면 경로 정보가 클립보드에 복사되어 카카오톡 등으로 공유 가능.
- **Developer Tools**:
  - **Context7 MCP**: 실시간 버전별 문서 제공으로 최신 iOS/Swift API 정보 활용

---

## 📦 설치 및 실행 방법

1. **Repository 복제**
   ```bash
   git clone https://github.com/Start-Up-Together-2024/DigitalCane-iOS.git
   cd DigitalCane-iOS
   ```

2. **API 키 설정**
   - `Secrets.plist` 파일을 프로젝트 루트에 생성합니다.
   - 아래 키를 추가합니다:
     - `GOOGLE_MAPS_API_KEY`: Google Cloud Console에서 발급
      - `GEMINI_API_KEY`: Google AI Studio에서 발급 (Gemini 2.0 Flash용)

3. **빌드 및 실행**
   - Xcode에서 `DigitalCane.xcodeproj`를 엽니다.
   - 실제 기기(iPhone)를 연결하고 빌드합니다 (나침반 및 진동 기능 테스트 필요).

4. **(선택) Context7 MCP 설정** (개발자용)
   - AI 코드 어시스턴트와 함께 작업하는 경우, 최신 iOS/Swift API 문서를 실시간으로 제공받을 수 있습니다.
   - `.gemini/mcp.json` 파일이 이미 설정되어 있습니다.
   - Node.js 18.0+ 필요:
     ```bash
     node --version  # v18.0.0 이상 확인
     ```
   - MCP 호환 AI 클라이언트 (Cursor, Claude Desktop, VS Code 등)에서 자동으로 활성화됩니다.

---

## 🤝 기여 (Contribute)

이 프로젝트는 오픈 소스이며, 시각장애인의 이동권 향상을 위한 모든 기여를 환영합니다.
- **Issue**: 버그 리포트나 기능 제안을 남겨주세요.
- **Pull Request**: 코드를 개선하고 PR을 보내주세요.

---

## 📄 라이선스

MIT License
